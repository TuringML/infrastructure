- name: "Create dashboard"
  shell: "kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v1.10.1/src/deploy/recommended/kubernetes-dashboard.yaml"
  when: state == "present"
- name: "Create eks-admin role"
  k8s_raw:
    state: "{{ state }}"
    definition: "{{ lookup('template', './deployment/rbac.yaml') | from_yaml }}"  
- name: Get admin token
  shell: kubectl -n kube-system describe secret $(kubectl -n kube-system get secret | grep eks-admin | awk '{print $1}')
  register: result
- debug:
  msg: "{{ result.stdout }}"

